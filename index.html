<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Detail Prompt Promosi AI</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel for in-browser JSX transformation -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Font: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #888; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #555; }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #fff;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        const HelpIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                <path d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286zm1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94z"/>
            </svg>
        );

        const App = () => {
            const [outputType, setOutputType] = useState('flyer');
            const [apiService, setApiService] = useState('gemini');
            const [apiKey, setApiKey] = useState('');
            const [generatedPromptId, setGeneratedPromptId] = useState('');
            const [generatedPromptEn, setGeneratedPromptEn] = useState('');
            const [copySuccess, setCopySuccess] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [isHelpModalOpen, setIsHelpModalOpen] = useState(false);
            const [activeTab, setActiveTab] = useState('id');

            const [inputs, setInputs] = useState({
                productName: 'Kopi Susu Gula Aren',
                targetAudience: 'Profesional Muda (25-35 tahun)',
                keyMessage: 'Peningkat semangat di pagi hari',
                promoType: 'Diskon Spesial',
                ctaText: 'Beli Sekarang, Diskon 50%!',
                visualStyle: 'Modern & Minimalis',
                aspectRatio: '4:5',
                videoDuration: '15 detik',
                musicMood: 'Ceria dan bersemangat',
                characterName: 'Bara',
                characterDesc: 'Seorang barista muda yang ramah dan penuh semangat',
                characterDialog: 'Pagi jadi lebih semangat dengan kopi spesial dari kami! Ada diskon 50% lho untuk kopi keduamu hari ini.'
            });

            const handleInputChange = (e) => {
                const { name, value } = e.target;
                setInputs(prev => ({ ...prev, [name]: value }));
            };

            const callApi = async (prompt, key, service) => {
                if (service === 'gemini') {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${key}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                    });
                    if (!response.ok) throw new Error(`Google AI Error: ${response.statusText}`);
                    const data = await response.json();
                    if (!data.candidates || !data.candidates[0].content.parts[0].text) {
                        throw new Error('Invalid response structure from Gemini API.');
                    }
                    return data.candidates[0].content.parts[0].text;
                } else { // OpenRouter (DeepSeek)
                    const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
                        method: 'POST',
                        headers: { 'Authorization': `Bearer ${key}`, 'Content-Type': 'application/json' },
                        body: JSON.stringify({ model: 'deepseek/deepseek-chat', messages: [{ role: 'user', content: prompt }] })
                    });
                    if (!response.ok) throw new Error(`OpenRouter Error: ${response.statusText}`);
                    const data = await response.json();
                    if (!data.choices || !data.choices[0].message.content) {
                        throw new Error('Invalid response structure from OpenRouter API.');
                    }
                    return data.choices[0].message.content;
                }
            };
            
            const buildRequestPrompt = () => {
                const { productName, targetAudience, keyMessage, promoType, ctaText, visualStyle, aspectRatio, videoDuration, musicMood, characterName, characterDesc, characterDialog } = inputs;

                if (outputType === 'flyer') {
                    return `Anda adalah seorang ahli prompt engineering. Buatkan sebuah prompt yang sangat detail dalam Bahasa Indonesia untuk AI Image Generator (seperti Midjourney atau DALL-E) guna membuat flyer promosi berdasarkan informasi berikut:
- **Produk:** ${productName}
- **Target Audiens:** ${targetAudience}
- **Pesan/Keunggulan:** ${keyMessage}
- **Teks Call-to-Action (CTA):** ${ctaText}
- **Jenis Promosi:** ${promoType}
- **Gaya Visual:** ${visualStyle}
- **Aspek Rasio:** ${aspectRatio}

Tolong buat prompt dalam format yang terstruktur, mencakup deskripsi visual, komposisi, pencahayaan, gaya teks, dan parameter teknis. **Pastikan Anda menulis "aspek rasio" secara lengkap, bukan "ar".**`;
                } else { // Video Prompt for Google Veo
                    return `Anda adalah seorang sutradara dan ahli prompt engineering untuk model AI video canggih seperti Google Veo. Buatkan sebuah prompt yang sangat komprehensif dalam Bahasa Indonesia untuk membuat video promosi berdasarkan detail berikut:
- **Produk:** ${productName}
- **Target Audiens:** ${targetAudience}
- **Pesan/Keunggulan:** ${keyMessage}
- **Teks Call-to-Action (CTA):** ${ctaText}
- **Durasi Video:** ${videoDuration}
- **Gaya Visual Keseluruhan:** ${visualStyle}
- **Suasana/Musik:** ${musicMood}
- **Karakter Utama:**
  - **Nama:** ${characterName}
  - **Deskripsi:** ${characterDesc}
  - **Dialog yang diucapkan:** "${characterDialog}"

Tolong buat prompt yang mencakup:
1.  **Deskripsi Sinematik Umum:** Jelaskan tampilan dan nuansa video secara keseluruhan.
2.  **Rancangan Adegan (Scene Breakdown):** Uraikan setiap adegan secara detail, termasuk gerakan kamera, aksi karakter, dan elemen visual.
3.  **Deskripsi Karakter:** Jelaskan penampilan dan ekspresi karakter.
4.  **Audio:** Detailkan musik dan efek suara.
5.  **Perintah Tambahan:** Sertakan kata kunci teknis untuk kualitas tinggi.`;
                }
            };

            const generatePrompt = async () => {
                if (!apiKey) {
                    alert('Silakan masukkan API Key Anda terlebih dahulu.');
                    return;
                }
                setIsLoading(true);
                setGeneratedPromptId('');
                setGeneratedPromptEn('');
                setActiveTab('id');

                const requestPrompt = buildRequestPrompt();

                try {
                    const idPrompt = await callApi(requestPrompt, apiKey, apiService);
                    setGeneratedPromptId(idPrompt);

                    const translationPrompt = `Tolong terjemahkan prompt berikut ke dalam Bahasa Inggris yang natural dan profesional untuk digunakan pada platform AI generatif. Terjemahkan secara akurat dan jaga struktur serta kata kunci teknisnya:\n\n---\n\n${idPrompt}`;
                    const enPrompt = await callApi(translationPrompt, apiKey, apiService);
                    setGeneratedPromptEn(enPrompt);

                } catch (error) {
                    console.error('API Error:', error);
                    alert(`Gagal menghubungi API. Periksa API Key Anda dan koneksi internet. Error: ${error.message}`);
                    setGeneratedPromptId('Terjadi kesalahan saat membuat prompt.');
                } finally {
                    setIsLoading(false);
                }
            };

            // --- FIXED copyToClipboard function ---
            const copyToClipboard = (text) => {
                const textArea = document.createElement("textarea");
                textArea.value = text;

                // Make the textarea invisible
                textArea.style.position = "fixed";
                textArea.style.top = "-9999px";
                textArea.style.left = "-9999px";

                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();

                try {
                    const successful = document.execCommand('copy');
                    if (successful) {
                        setCopySuccess('Prompt berhasil disalin!');
                    } else {
                        setCopySuccess('Gagal menyalin prompt.');
                    }
                } catch (err) {
                    console.error('Copy to clipboard failed', err);
                    setCopySuccess('Gagal menyalin prompt.');
                }

                document.body.removeChild(textArea);
                setTimeout(() => setCopySuccess(''), 2000);
            };

            return (
                <div className="min-h-screen bg-gray-100 p-4 sm:p-8">
                    <div className="max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-8">
                        
                        <div className="bg-white p-6 rounded-xl shadow-lg flex flex-col">
                            <h1 className="text-3xl font-bold text-gray-800 mb-2">Generator Detail Prompt AI</h1>
                            <p className="text-gray-500 mb-6">Buat prompt profesional untuk flyer & video promosi Anda.</p>
                            
                            <div className="space-y-4 overflow-y-auto custom-scrollbar pr-2 flex-grow">
                                <fieldset className="border border-gray-300 p-4 rounded-lg">
                                    <legend className="text-sm font-semibold text-gray-600 px-2">Pengaturan AI</legend>
                                    <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">Layanan AI</label>
                                            <select value={apiService} onChange={e => setApiService(e.target.value)} className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                                <option value="gemini">Google Gemini</option>
                                                <option value="deepseek">DeepSeek (OpenRouter)</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">API Key</label>
                                            <div className="flex items-center space-x-2">
                                                <input type="password" value={apiKey} onChange={e => setApiKey(e.target.value)} placeholder="Masukkan API Key Anda" className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" />
                                                <button onClick={() => setIsHelpModalOpen(true)} className="text-gray-500 hover:text-blue-600 shrink-0"><HelpIcon /></button>
                                            </div>
                                        </div>
                                    </div>
                                </fieldset>

                                <div className="mb-6">
                                    <label className="block text-lg font-semibold text-gray-700 mb-3">1. Pilih Output</label>
                                    <div className="flex rounded-lg bg-gray-200 p-1">
                                        <button onClick={() => setOutputType('flyer')} className={`w-full py-2 rounded-md text-sm font-semibold transition-colors ${outputType === 'flyer' ? 'bg-white text-blue-600 shadow' : 'bg-transparent text-gray-600'}`}>Prompt Flyer</button>
                                        <button onClick={() => setOutputType('video')} className={`w-full py-2 rounded-md text-sm font-semibold transition-colors ${outputType === 'video' ? 'bg-white text-blue-600 shadow' : 'bg-transparent text-gray-600'}`}>Prompt Video (Veo)</button>
                                    </div>
                                </div>
                                
                                <div className="space-y-4">
                                    <h3 className="text-lg font-semibold text-gray-700">2. Isi Detail Promosi</h3>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Nama Produk</label>
                                        <input type="text" name="productName" value={inputs.productName} onChange={handleInputChange} className="w-full px-3 py-2 border border-gray-300 rounded-md" />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Target Audiens</label>
                                        <input type="text" name="targetAudience" value={inputs.targetAudience} onChange={handleInputChange} className="w-full px-3 py-2 border border-gray-300 rounded-md" />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Pesan Utama / Keunggulan</label>
                                        <input type="text" name="keyMessage" value={inputs.keyMessage} onChange={handleInputChange} className="w-full px-3 py-2 border border-gray-300 rounded-md" />
                                    </div>
                                     <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Teks CTA (Call to Action)</label>
                                        <input type="text" name="ctaText" value={inputs.ctaText} onChange={handleInputChange} className="w-full px-3 py-2 border border-gray-300 rounded-md" />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Gaya Visual</label>
                                        <select name="visualStyle" value={inputs.visualStyle} onChange={handleInputChange} className="w-full px-3 py-2 border border-gray-300 rounded-md">
                                            <option>Modern & Minimalis</option><option>Elegan & Mewah</option><option>Ceria & Penuh Warna</option><option>Vintage & Retro</option><option>Futuristik & Teknologi</option>
                                        </select>
                                    </div>
                                    {outputType === 'flyer' ? (
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-1">Aspek Rasio</label>
                                            <select name="aspectRatio" value={inputs.aspectRatio} onChange={handleInputChange} className="w-full px-3 py-2 border border-gray-300 rounded-md">
                                                <option>4:5 (Social Media Post)</option><option>9:16 (Story)</option><option>1:1 (Square)</option><option>16:9 (Widescreen)</option>
                                            </select>
                                        </div>
                                    ) : (
                                        <>
                                            <h3 className="text-lg font-semibold text-gray-700 pt-4">3. Detail Video (Untuk Veo)</h3>
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-1">Nama Karakter</label>
                                                <input type="text" name="characterName" value={inputs.characterName} onChange={handleInputChange} className="w-full px-3 py-2 border border-gray-300 rounded-md" />
                                            </div>
                                             <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-1">Deskripsi Karakter</label>
                                                <input type="text" name="characterDesc" value={inputs.characterDesc} onChange={handleInputChange} className="w-full px-3 py-2 border border-gray-300 rounded-md" />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-1">Dialog Karakter</label>
                                                <textarea name="characterDialog" value={inputs.characterDialog} onChange={handleInputChange} rows="3" className="w-full px-3 py-2 border border-gray-300 rounded-md"></textarea>
                                            </div>
                                        </>
                                    )}
                                </div>
                            </div>
                            <button onClick={generatePrompt} disabled={isLoading} className="mt-8 w-full py-3 bg-blue-600 text-white font-bold rounded-md hover:bg-blue-700 transition-colors shadow-lg disabled:bg-blue-400 flex items-center justify-center">
                                {isLoading ? <div className="loader"></div> : 'Buat Detail Prompt dengan AI'}
                            </button>
                        </div>

                        <div className="bg-gray-800 p-6 rounded-xl shadow-lg flex flex-col">
                            <h2 className="text-xl font-semibold text-white mb-4">Hasil Detail Prompt</h2>
                             <div className="flex border-b border-gray-700 mb-2">
                                <button onClick={() => setActiveTab('id')} className={`py-2 px-4 text-sm font-medium ${activeTab === 'id' ? 'text-white border-b-2 border-blue-500' : 'text-gray-400 hover:text-gray-200'}`}>Bahasa Indonesia</button>
                                <button onClick={() => setActiveTab('en')} className={`py-2 px-4 text-sm font-medium ${activeTab === 'en' ? 'text-white border-b-2 border-blue-500' : 'text-gray-400 hover:text-gray-200'}`}>English</button>
                            </div>
                            <div className="flex-grow flex flex-col">
                                {activeTab === 'id' ? (
                                    <textarea readOnly value={generatedPromptId} placeholder="Hasil prompt dalam Bahasa Indonesia akan muncul di sini..." className="w-full flex-grow bg-gray-900 text-gray-300 p-4 rounded-md border border-gray-700 custom-scrollbar whitespace-pre-wrap"></textarea>
                                ) : (
                                    <textarea readOnly value={generatedPromptEn} placeholder="English prompt result will appear here..." className="w-full flex-grow bg-gray-900 text-gray-300 p-4 rounded-md border border-gray-700 custom-scrollbar whitespace-pre-wrap"></textarea>
                                )}
                                {generatedPromptId && !isLoading && (
                                    <button onClick={() => copyToClipboard(activeTab === 'id' ? generatedPromptId : generatedPromptEn)} className="mt-4 w-full py-2 bg-green-500 text-white font-semibold rounded-md hover:bg-green-600 transition-colors">
                                        {copySuccess || `Salin Prompt (${activeTab === 'id' ? 'ID' : 'EN'})`}
                                    </button>
                                )}
                            </div>
                        </div>
                    </div>

                    {isHelpModalOpen && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                            <div className="bg-white rounded-lg shadow-xl p-6 max-w-lg w-full">
                                <h3 className="text-xl font-bold mb-4">Cara Mendapatkan API Key</h3>
                                <div className="space-y-4">
                                    <div>
                                        <h4 className="font-semibold text-gray-800">Untuk Google Gemini:</h4>
                                        <ol className="list-decimal list-inside space-y-1 text-gray-700 mt-1">
                                            <li>Buka situs **Google AI Studio**.</li>
                                            <li>Login dengan akun Google Anda.</li>
                                            <li>Klik tombol **"Get API key"** di menu sebelah kiri.</li>
                                            <li>Klik **"Create API key in new project"**.</li>
                                            <li>Salin (Copy) API Key yang muncul.</li>
                                        </ol>
                                    </div>
                                    <div>
                                        <h4 className="font-semibold text-gray-800">Untuk DeepSeek (via OpenRouter):</h4>
                                        <ol className="list-decimal list-inside space-y-1 text-gray-700 mt-1">
                                            <li>Buka situs **OpenRouter.ai**, lalu `Log in` atau `Sign up`.</li>
                                            <li>Klik ikon profil Anda di pojok kanan atas dan pilih **Keys**.</li>
                                            <li>Klik tombol **+ Create Key**.</li>
                                            <li>Beri nama kunci Anda (misal: "Aplikasi Prompt") lalu klik **Create**.</li>
                                            <li>Salin (Copy) API Key yang baru saja dibuat.</li>
                                        </ol>
                                    </div>
                                </div>
                                <button onClick={() => setIsHelpModalOpen(false)} className="mt-6 w-full bg-blue-500 text-white py-2 rounded-md hover:bg-blue-600 transition-colors">Mengerti</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>
